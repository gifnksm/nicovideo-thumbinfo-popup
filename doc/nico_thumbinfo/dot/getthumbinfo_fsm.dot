digraph getthuminfo_fsm {
    rankdir = LR;

    node [shape = box];

    init [label = "init", peripheries = 2];

    node [style = filled, fillcolor = "#99cc99", peripheries = 2];
    completed [label = "completed"];

    node [style = filled, fillcolor = "#9999cc", peripheries = 1];
    load_getthumbinfo [label = "loading\n(target=GetThumbinfo)"];
    load_getflv [label = "loading\n(target=GetFlv)"];

    node [style = filled, fillcolor = "#cc9999", peripheries = 2];
    error_fetch [label = "error\n(errcode=UrlFetch)"];
    error_status [label = "error\n(errcode=HttpStatus)"];
    error_empty [label = "error\n(errcode=ServerMaintenance)"];
    error_invalid [label = "error\n(errcode=Invalid)"];
    error_deleted [label = "error\n(errcode=Deleted)"];
    error_community [label = "error\n(errcode=Community)"];
    error_notfound [ label = "error\n(errcode=NotFound)"];
    error_getflv [label = "error\n(errcode=GetFlv)"];

    init -> load_getthumbinfo;

    load_getthumbinfo -> completed [label = "ok"];
    load_getthumbinfo -> error_fetch [label = "errcode=UrlFetch"];
    load_getthumbinfo -> error_status [label = "errcode=HttpStatus"];
    load_getthumbinfo -> error_empty [label = "errcode=ServerMaintenance"];
    load_getthumbinfo -> error_invalid [label = "errcode=Invalid"];
    load_getthumbinfo -> error_deleted [label = "errcode=Deleted"];
    load_getthumbinfo -> error_community [label = "errcode=Community"]
    load_getthumbinfo -> load_getflv [label = "errcode=CommunitySubThread"];
    load_getthumbinfo -> error_notfound [label = "errcode=NotFound"];

    load_getflv -> error_getflv;
    load_getflv -> load_getthumbinfo [label = "ok (TID != OTID)"];
}
